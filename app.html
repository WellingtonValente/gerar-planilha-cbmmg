<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gerador de Planilhas – Eng. Wellington Valente</title>
<script src="./xlsx.full.min.js"></script>
<style>
  body {
    font-family: "Segoe UI", Roboto, sans-serif;
    background: linear-gradient(135deg, #b71c1c, #212121);
    color: #fff;
    margin: 0; padding: 0;
    display: flex; flex-direction: column; align-items: center;
  }
  header {
    padding: 20px;
    text-align: center;
    background: rgba(0,0,0,0.3);
  }
  h1 { margin: 0; }
  textarea {
    width: 90%; max-width: 800px; height: 200px;
    margin-top: 20px; border-radius: 8px; padding: 10px;
    border: none; font-size: 15px;
  }
  input {
    padding: 10px; margin: 10px;
    border-radius: 5px; border: none;
  }
  .btn {
    background: #ffc107; color: #000;
    padding: 10px 16px; border-radius: 6px;
    border: none; cursor: pointer;
    font-weight: 600;
  }
  footer {
    margin-top: 40px;
    font-size: 14px; opacity: 0.8;
    text-align: center;
  }
  a.voltar { color: #ffc107; text-decoration: none; margin-top: 20px; display: inline-block; }
</style>
</head>

<body>
  <header>
    <h1>Gerador de Planilhas (.xlsx / .csv)</h1>
    <p>Ferramenta gratuita do Eng. Wellington G. Valente – CREA-MG 160.396/D</p>
  </header>

  <a class="voltar" href="./">← Voltar à página inicial</a>

  <textarea id="input" placeholder="Cole aqui seu CSV ou JSON gerado pelo GPT"></textarea><br>
  <input id="sheet" placeholder="Nome da aba" value="Planilha" />
  <input id="file" placeholder="Nome do arquivo" value="planilha_cbmmg.xlsx" />
  <div>
    <button class="btn" onclick="toExcel()">Gerar .xlsx</button>
    <button class="btn" onclick="toCSV()">Baixar .csv</button>
    <button class="btn" onclick="limpar()">Limpar</button>
  </div>

  <footer>
    © 2025 – Eng. Wellington G. Valente | Segurança contra Incêndios em MG
  </footer>

<script>
function toExcel(){
  const txt = document.getElementById("input").value.trim();
  if(!txt){ alert("Cole seu CSV ou JSON primeiro!"); return; }
  let wb = XLSX.utils.book_new(), ws;
  try {
    if(txt.startsWith("[")) {
      ws = XLSX.utils.json_to_sheet(JSON.parse(txt));
    } else {
      ws = XLSX.utils.aoa_to_sheet(txt.split(/\n/).map(r=>r.split(",")));
    }
  } catch(e){ alert("Erro ao processar dados!"); return; }
  XLSX.utils.book_append_sheet(wb, ws, document.getElementById("sheet").value || "Planilha");
  XLSX.writeFile(wb, document.getElementById("file").value || "planilha.xlsx");
}
function toCSV(){
  const txt = document.getElementById("input").value.trim();
  if(!txt){ alert("Cole seu CSV primeiro!"); return; }
  const blob = new Blob([txt], {type: "text/csv;charset=utf-8"});
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = (document.getElementById("file").value || "planilha.csv");
  link.click();
}
function limpar(){ document.getElementById("input").value = ""; }
</script>
</body>
</html>
